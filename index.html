<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ุจูุตูุฉ ุงูุฃุซุฑ - ุงุฎุชุจุงุฑ ุงููุณุงุฑ</title>
  <style>
    /* =======================
       ุงูุฎุท ุงูุนุฑุจู - DIN Next Arabic
       ======================= */
    @font-face {
      font-family: 'DINNextArabic';
      src: url('fonts/DINNextLTArabic-Regular.ttf') format('truetype'),
           url('fonts/DIN NEXTโข๏ธ ARABIC BOLD 2.otf') format('opentype'),
           url('fonts/DIN NEXTโข๏ธ ARABIC HEAVY 3.otf') format('opentype'),
           url('fonts/DIN NEXTโข๏ธ ARABIC ULTRALIGHT 2.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    body {
      font-family: 'DINNextArabic', Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      direction: rtl;
    }

    .container {
      max-width: 700px;
      margin: 30px auto;
      background: #ffffff;
      padding: 20px 25px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .logo {
      display: block;
      margin: 0 auto 10px;
      width: 160px;
    }

    h1 {
      text-align: center;
      color: #4a148c;
      margin-top: 10px;
    }

    p {
      line-height: 1.7;
      font-size: 15px;
      color: #444;
    }

    label {
      display: block;
      margin: 6px 0;
      font-size: 14px;
      cursor: pointer;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    .btn {
      display: inline-block;
      padding: 10px 18px;
      margin-top: 10px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      background-color: #4a148c;
      color: #fff;
      font-weight: bold;
    }

    .btn.secondary {
      background-color: #777;
    }

    .question {
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 8px;
      background: #fafafa;
      border: 1px solid #eee;
    }

    .question p {
      margin: 0 0 6px;
      font-weight: 600;
      color: #333;
    }

    .result-box {
      margin-top: 15px;
      padding: 12px;
      border-radius: 8px;
      background: #e8f5e9;
      border: 1px solid #c8e6c9;
      text-align: center;
      font-size: 15px;
      display: none;
    }

    .restart-btn {
      display: none;
      margin: 10px auto 0;
      text-align: center;
    }
  </style>
</head>
<body>

<div class="container" id="form-container">

  <!-- ุงูููุฌู -->
  <img src="one-logo.png" alt="ูู One" class="logo" />

  <h1>๐งญ ุจูุตูุฉ ุงูุฃุซุฑ</h1>
  <p style="text-align:center;">
    ุณุฌูู ุจูุงูุงุชูุ ุฌุงูุจ ุนูู ุงูุฃุณุฆูุฉ ุงูุณุจุนุฉุ ููุนุฑููู ุนูู ุงููุณุงุฑ ุงูุฃูุฑุจ ูุดุฎุตูุชู
    ูุน ุญูุธ ุฌููุน ุงููุชุงุฆุฌ ูู ููู Excel (CSV) ูุงุญุฏ.
  </p>

  <!-- ุจูุงูุงุช ุงููุณุชุฎุฏู -->
  <div id="user-form">
    <label for="name">ุงูุงุณู ุงููุงูู</label>
    <input type="text" id="name" placeholder="ุงูุชุจ ุงุณูู ููุง" />

    <label for="email">ุงูุฅูููู</label>
    <input type="email" id="email" placeholder="example@email.com" />

    <label for="phone">ุฑูู ุงูุฌูุงู</label>
    <input type="tel" id="phone" placeholder="05xxxxxxxx" />

    <button class="btn" onclick="startQuiz()">ุงุจุฏุฃ ุงูุงุฎุชุจุงุฑ</button>
  </div>

  <!-- ุงูุฃุณุฆูุฉ -->
  <div id="quiz" style="display:none; margin-top:15px;">
    <h3>ุงูุฃุณุฆูุฉ</h3>

    <div class="question"><p>1. ููุง ุชูุงุฌู ุชุญุฏููุ ูุด ุฃูู ุดูุก ุชุณูููุ</p>
      <label><input type="radio" name="q1" value="A"> ุชุฎุทุท ูุชุฌูุน ุงููุนูููุงุช</label>
      <label><input type="radio" name="q1" value="B"> ุชุจุชูุฑ ููุฑุฉ ุฌุฏูุฏุฉ</label>
      <label><input type="radio" name="q1" value="C"> ุชุชูุงุตู ูุน ุงูุขุฎุฑูู ูุญููู</label>
      <label><input type="radio" name="q1" value="D"> ุชูุซู ูู ุดูุก ุจุฎุทูุงุช ูุงุถุญุฉ</label>
    </div>

    <div class="question"><p>2. ุฃูุซุฑ ุดู ุชุญุจูู ูู ุงูุดุบู ุงูุฌูุงุนูุ</p>
      <label><input type="radio" name="q2" value="A"> ุงูุชูุธูู ูุงูุชูุฒูุน</label>
      <label><input type="radio" name="q2" value="B"> ุงูุนุตู ุงูุฐููู ูุงูุฅุจุฏุงุน</label>
      <label><input type="radio" name="q2" value="C"> ุงูุญูุงุณ ูุงูุทุงูุฉ ุจูู ุงููุฑูู</label>
      <label><input type="radio" name="q2" value="D"> ุงูุชูุซูู ูุงููุชุงุฆุฌ ุงูููุงุฆูุฉ</label>
    </div>

    <div class="question"><p>3. ุชูุถูู ุชููู ุฎูู ุงูููุงููุณ ููุง ูู ุงููุงุฌูุฉุ</p>
      <label><input type="radio" name="q3" value="A"> ุฎูู ุงูููุงููุณ โ ุฃุญุจ ุฃุถุจุท ุงูุชูุงุตูู</label>
      <label><input type="radio" name="q3" value="B"> ูู ุงููุงุฌูุฉ โ ุฃุญุจ ุฃุชููู ูุฃููุน</label>
      <label><input type="radio" name="q3" value="C"> ุจูู ุงูุงุซููู โ ุฃูุงุฒู ุจูู ุงูููุฑุฉ ูุงูุชูููุฐ</label>
      <label><input type="radio" name="q3" value="D"> ูุง ูููุ ุงูููู ููุฌุญ ุงูุนูู</label>
    </div>

    <div class="question"><p>4. ุฃูุซุฑ ุดู ูุฌุฐุจู ูู ุงููุดุงุฑูุน ุงูุฅุนูุงููุฉุ</p>
      <label><input type="radio" name="q4" value="A"> ุงูุชุฎุทูุท ูุงูุฌุฏููุฉ</label>
      <label><input type="radio" name="q4" value="B"> ุงูุฅุจุฏุงุน ูุงููููุฉ</label>
      <label><input type="radio" name="q4" value="C"> ุงูุนูุงูุงุช ูุงูุชูุงุนู ูุน ุงูุฌูููุฑ</label>
      <label><input type="radio" name="q4" value="D"> ุงูุชูุซูู ูุงูุฅุฎุฑุงุฌ ุงูููุงุฆู</label>
    </div>

    <div class="question"><p>5. ููุง ุชุดูู ููุฑุฉ ุฌุฏูุฏุฉุ ูุด ุฃูู ุดู ูุฎุทุฑ ุจุจุงููุ</p>
      <label><input type="radio" name="q5" value="A"> ููู ููุฏุฑ ูุทุจูููุง ุนููููุงุ</label>
      <label><input type="radio" name="q5" value="B"> ููู ูุฎูููุง ุฃูุซุฑ ุฅุจุฏุงุนูุงุ</label>
      <label><input type="radio" name="q5" value="C"> ููู ููุตููุง ูููุงุณุ</label>
      <label><input type="radio" name="q5" value="D"> ููู ููุซูููุง ุฃู ูููุณ ุฃุซุฑูุงุ</label>
    </div>

    <div class="question"><p>6. ุฅุฐุง ุงูุถูููุช ููุฑูู โูููโุ ุฃู ุฏูุฑ ููุงุณุจู ุฃูุซุฑุ</p>
      <label><input type="radio" name="q6" value="A"> ููุณูู ุงููุดุฑูุน โ ุฃุญุจ ุงูุชูุธูู ูุงููุชุงุจุนุฉ</label>
      <label><input type="radio" name="q6" value="B"> ุงููุจุฏุน โ ุฃุตูุบ ุงูุฃููุงุฑ ูุฃุตููู ุงูุชุฌุงุฑุจ</label>
      <label><input type="radio" name="q6" value="C"> ุงููุชุญุฏุซ โ ุฃุจุฑุน ูู ุงูุฅููุงุน ูุงูุชูุซูู ูุงูุธููุฑ</label>
      <label><input type="radio" name="q6" value="D"> ุงูููุชุฌ โ ุฃูููุฐ ุจุฏูุฉ ูุฃูุตู ุงููุชูุฌุฉ ุงูููุงุฆูุฉ</label>
    </div>

    <div class="question"><p>7. ูุด ุฃูุซุฑ ุดุนูุฑ ุชุญุจ ุชุญููู ุจุนุฏ ุฅูุฌุงุฒ ูุดุฑูุนุ</p>
      <label><input type="radio" name="q7" value="A"> ุฅููุง ููุฐูุง ุงูุฎุทุฉ ุจุฏูุฉ</label>
      <label><input type="radio" name="q7" value="B"> ุฅููุง ูุฏููุง ููุฑุฉ ุบูุฑ ูุณุจููุฉ</label>
      <label><input type="radio" name="q7" value="C"> ุฅููุง ุฃุซุฑูุง ูู ุงููุงุณ</label>
      <label><input type="radio" name="q7" value="D"> ุฅููุง ูุซููุง ุชุฌุฑุจุฉ ุชุณุชุญู ุงูุชูุฑุงุฑ</label>
    </div>

    <button class="btn" onclick="submitQuiz()">ุฅุธูุงุฑ ุงููุชูุฌุฉ + ุชุญุฏูุซ ููู Excel</button>
  </div>

  <div id="result" class="result-box"></div>

  <div class="restart-btn" id="restart-btn">
    <button class="btn secondary" onclick="resetQuiz()">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ ูู ุงูุจุฏุงูุฉ</button>
  </div>
</div>

<script>
  const personaLabels = {
    A: "Analysis Person",
    B: "Creative Person",
    C: "PR Person",
    D: "Reliable Person"
  };

  const personaDescriptions = {
    A: "ูุฑูุฒ ุนูู ุงูุชุญููู ูุงูุชุฎุทูุท ูุงูููุทูุ ููุญุจ ุงูุชูุธูู ูุงูุฏูุฉ ูู ุงูุนูู.",
    B: "ูููุฏ ุงูุฃููุงุฑ ุงูุฌุฏูุฏุฉ ููุชูููุฒ ุจุงูุฎูุงู ูุงูุฅุจุฏุงุนุ ูุฑู ุงูุนุงูู ููุฌุงู ููุงุจุชูุงุฑ.",
    C: "ูุชูู ุงูุชูุงุตู ูุงูุฅููุงุน ูุงูุชูุซูู ุงูุชูุงุนููุ ููุญุจ ุฃู ูููู ูู ููุจ ุงูุญุฏุซ.",
    D: "ุดุฎุต ููุซูู ูููู ุงูุงุนุชูุงุฏ ุนูููุ ููุชู ุจุงูุชูููุฐ ูุงูุฌูุฏุฉ ูุงูุชูุซูู ููููุงูุฉ."
  };

  let finalPersona = null;
  let finalPercentage = 0;
  const submissions = [];

  function startQuiz() {
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();

    if (!name || !email || !phone) {
      alert('ูู ูุถูู ุงูุชุจ ุงูุงุณู ูุงูุฅูููู ูุฑูู ุงูุฌูุงู ูุจู ูุง ุชุจุฏุฃ.');
      return;
    }
    document.getElementById('quiz').style.display = 'block';
  }

  function submitQuiz() {
    const total = 7;
    const counts = { A:0, B:0, C:0, D:0 };
    const answers = {};

    for (let i = 1; i <= total; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (!selected) {
        alert('ูู ูุถูู ุฌุงูุจ ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ุงูุณุจุนุฉ ูุจู ุฅุธูุงุฑ ุงููุชูุฌุฉ.');
        return;
      }
      answers[`q${i}`] = selected.value;
      counts[selected.value]++;
    }

    let max = -1, chosen = 'A';
    ['A','B','C','D'].forEach(k => { if (counts[k] > max) { max = counts[k]; chosen = k; } });

    finalPersona = chosen;
    finalPercentage = Math.round((max / total) * 100);

    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const trackName = personaLabels[chosen];
    const desc = personaDescriptions[chosen];

    const result = document.getElementById('result');
    result.style.display = 'block';
    result.innerHTML = `
      ุงููุณุงุฑ ุงูุฃูุณุจ ูู: <strong>${trackName}</strong><br>
      ูุณุจุฉ ุงูุชูุงูู: <strong>${finalPercentage}%</strong><br>
      <span style="font-size:13px; color:#555;">${desc}</span>
    `;

    document.getElementById('restart-btn').style.display = 'block';

    submissions.push({ name, email, phone, ...answers, persona: trackName, percentage: finalPercentage });
    downloadCSV();
  }

  function downloadCSV() {
    if (submissions.length === 0) return;

    const headers = ["Name","Email","Phone","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Persona","Percentage"];
    const rows = submissions.map(s => [s.name, s.email, s.phone, s.q1, s.q2, s.q3, s.q4, s.q5, s.q6, s.q7, s.persona, s.percentage + "%"]);
    let csvContent = headers.join(",") + "\n";
    rows.forEach(r => { csvContent += r.map(v => `"${(v || "").toString().replace(/"/g,'""')}"`).join(",") + "\n"; });

    const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.setAttribute("download", "impact_compass_results.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  function resetQuiz() {
    document.getElementById('name').value = "";
    document.getElementById('email').value = "";
    document.getElementById('phone').value = "";
    document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
    document.getElementById('quiz').style.display = 'none';
    document.getElementById('result').style.display = 'none';
    document.getElementById('restart-btn').style.display = 'none';
    finalPersona = null;
    finalPercentage = 0;
  }
</script>

</body>
</html>